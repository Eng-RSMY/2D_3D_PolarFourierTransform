clear ;
clc;

Size = 5;               % must be odd

%% Symbols for scaling
N = Size -1;
M = Size + 1;                                    % Number of angles
L = (M-2)/4;                                   % Number of levels
if(rem(M-2,4) ~= 0)
    L = ceil (L);                % use + 1 to compute for 45
end

alphas = sym('alpha__',[1 M]);        % There are redundant alphas and betas
assume(alphas,'real');
betas = sym('beta__',[1 M]);
assume(betas ,'real');


%% Symbols for my image and polar grid
Image = sym('a',[Size Size]);
assume(Image,'real');
PolarG = sym('b',[M Size]);
syms Interim W


for m =1:M 
    str = [ 'c', num2str(m), '__'];
    currentMat = sym (str, [Size Size]);
    Interim  = [ Interim ; reshape(currentMat,[Size*Size 1])];
end

rowStackedPolarG = reshape (PolarG.', [ M*Size 1]);
columnStackedImage = reshape(Image,[Size*Size 1]);
columnStackedIntermediate = Interim(2:(M*Size*Size+1) );

%% Preparing the matrix for ones and zeros
fullSize =  Size*Size;
zerosCell = cell(fullSize-1 , 1 );
for h = 1: fullSize-1
    zerosCell{h} = 0;
end
% onesCell = cell(1, fullSize );
% for h = 1:fullSize
%     onesCell{h} = 1;
% end
indexes = 1:fullSize;


%% Creating Ux = Interim using linear algebra

% W = -2*pi*1i/(Size+1);        This is a simple factor defined but not  used for symbolic simplicity
spacing = -(Size-1)/2:(Size-1)/2;
gridSpace = spacing'*spacing;
syms FrFTUni1DBlock  FrFTVarBlock U___  V___

for m =1:m
    angle = (m-1)*180/M;
    alpha_m = alphas(m);
    
    if (angle <= 45 || angle >= 135)
        for n =1:Size          % Row wise FrFT uniform alpha
            row = Image(n, :);
            FrFTUniBlock =  exp(W*alpha_m* gridSpace) * row' ;
            for k =1:Size
                for z = 1: fullSize
                    U___( k + (n-1)*Size + (m-1)*Size^2, z) = subs(FrFTUniBlock(k) , columnStackedImage (indexes (indexes ~= z)), zerosCell )/(columnStackedImage(z)) ;  % get element a_m_n
                end
                U___(k + (n-1)*Size+ (m-1)*Size^2, :)
            end
        end
    else
        for n =1:Size          % Column wise FrFT uniform alpha
            col = Image(:,n);
            FrFTUniBlock =  exp(W*alpha_m*gridSpace) * col ;
            for k =1:Size
                for z = 1: fullSize
                    U___( k + (n-1)*Size+ (m-1)*Size^2, z) = subs(FrFTUniBlock(k) , columnStackedImage (indexes (indexes ~= z)), zerosCell )/(columnStackedImage(z)) ;  % get element a_m_n
                end
                U___(k + (n-1)*Size+ (m-1)*Size^2, :)
            end
        end
    end
end

U___

U___* columnStackedImage


%% Creating VUx = b

% columnStackedIntermediate = U___*columnStackedImage;          % Temp = Ux
syms beta__1 beta__2 beta__3 beta__4 beta__5 beta__6

V___ = [ exp(4*W*beta__1), exp(2*W*beta__1), 1, exp(-2*W*beta__1), exp(-4*W*beta__1),                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0, exp(2*W*beta__1), exp(W*beta__1), 1, exp(-W*beta__1), exp(-2*W*beta__1), 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 1, 1, 1, 1, 1,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0, exp(-2*W*beta__1), exp(-W*beta__1), 1, exp(W*beta__1), exp(2*W*beta__1),                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0, exp(-4*W*beta__1), exp(-2*W*beta__1), 1, exp(2*W*beta__1), exp(4*W*beta__1),                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0, exp(4*W*beta__2), exp(2*W*beta__2), 1, exp(-2*W*beta__2), exp(-4*W*beta__2),                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0, exp(2*W*beta__2), exp(W*beta__2), 1, exp(-W*beta__2), exp(-2*W*beta__2), 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 1, 1, 1, 1, 1,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0, exp(-2*W*beta__2), exp(-W*beta__2), 1, exp(W*beta__2), exp(2*W*beta__2),                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0, exp(-4*W*beta__2), exp(-2*W*beta__2), 1, exp(2*W*beta__2), exp(4*W*beta__2),                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0, exp(4*W*beta__3),                0, 0,                 0,                 0, exp(2*W*beta__3),              0, 0,               0,                 0, 1, 0, 0, 0, 0, exp(-2*W*beta__3),               0, 0,              0,                0, exp(-4*W*beta__3),                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0, exp(2*W*beta__3), 0,                 0,                 0,                0, exp(W*beta__3), 0,               0,                 0, 0, 1, 0, 0, 0,                 0, exp(-W*beta__3), 0,              0,                0,                 0, exp(-2*W*beta__3), 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 1,                 0,                 0,                0,              0, 1,               0,                 0, 0, 0, 1, 0, 0,                 0,               0, 1,              0,                0,                 0,                 0, 1,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0, exp(-2*W*beta__3),                 0,                0,              0, 0, exp(-W*beta__3),                 0, 0, 0, 0, 1, 0,                 0,               0, 0, exp(W*beta__3),                0,                 0,                 0, 0, exp(2*W*beta__3),                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0, exp(-4*W*beta__3),                0,              0, 0,               0, exp(-2*W*beta__3), 0, 0, 0, 0, 1,                 0,               0, 0,              0, exp(2*W*beta__3),                 0,                 0, 0,                0, exp(4*W*beta__3),                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0, exp(4*W*beta__4),                0, 0,                 0,                 0, exp(2*W*beta__4),              0, 0,               0,                 0, 1, 0, 0, 0, 0, exp(-2*W*beta__4),               0, 0,              0,                0, exp(-4*W*beta__4),                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0, exp(2*W*beta__4), 0,                 0,                 0,                0, exp(W*beta__4), 0,               0,                 0, 0, 1, 0, 0, 0,                 0, exp(-W*beta__4), 0,              0,                0,                 0, exp(-2*W*beta__4), 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 1,                 0,                 0,                0,              0, 1,               0,                 0, 0, 0, 1, 0, 0,                 0,               0, 1,              0,                0,                 0,                 0, 1,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0, exp(-2*W*beta__4),                 0,                0,              0, 0, exp(-W*beta__4),                 0, 0, 0, 0, 1, 0,                 0,               0, 0, exp(W*beta__4),                0,                 0,                 0, 0, exp(2*W*beta__4),                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0, exp(-4*W*beta__4),                0,              0, 0,               0, exp(-2*W*beta__4), 0, 0, 0, 0, 1,                 0,               0, 0,              0, exp(2*W*beta__4),                 0,                 0, 0,                0, exp(4*W*beta__4),                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0, exp(4*W*beta__5),                0, 0,                 0,                 0, exp(2*W*beta__5),              0, 0,               0,                 0, 1, 0, 0, 0, 0, exp(-2*W*beta__5),               0, 0,              0,                0, exp(-4*W*beta__5),                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0, exp(2*W*beta__5), 0,                 0,                 0,                0, exp(W*beta__5), 0,               0,                 0, 0, 1, 0, 0, 0,                 0, exp(-W*beta__5), 0,              0,                0,                 0, exp(-2*W*beta__5), 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 1,                 0,                 0,                0,              0, 1,               0,                 0, 0, 0, 1, 0, 0,                 0,               0, 1,              0,                0,                 0,                 0, 1,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0, exp(-2*W*beta__5),                 0,                0,              0, 0, exp(-W*beta__5),                 0, 0, 0, 0, 1, 0,                 0,               0, 0, exp(W*beta__5),                0,                 0,                 0, 0, exp(2*W*beta__5),                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0, exp(-4*W*beta__5),                0,              0, 0,               0, exp(-2*W*beta__5), 0, 0, 0, 0, 1,                 0,               0, 0,              0, exp(2*W*beta__5),                 0,                 0, 0,                0, exp(4*W*beta__5),                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0, exp(4*W*beta__6), exp(2*W*beta__6), 1, exp(-2*W*beta__6), exp(-4*W*beta__6),                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0, exp(2*W*beta__6), exp(W*beta__6), 1, exp(-W*beta__6), exp(-2*W*beta__6), 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 1, 1, 1, 1, 1,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0, exp(-2*W*beta__6), exp(-W*beta__6), 1, exp(W*beta__6), exp(2*W*beta__6),                 0,                 0, 0,                0,                0;
                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0,                 0,                 0, 0,                0,                0,                0,                0, 0,                 0,                 0,                0,              0, 0,               0,                 0, 0, 0, 0, 0, 0,                 0,               0, 0,              0,                0, exp(-4*W*beta__6), exp(-2*W*beta__6), 1, exp(2*W*beta__6), exp(4*W*beta__6)];
            
 %Transformation 
 syms alpha__1 alpha__2 alpha__3 alpha__4 alpha__5 alpha__6
 T =  [exp(-2*W*(alpha__1 + beta__1)) + exp(2*W*(alpha__1 + beta__1)) + exp(-4*W*(alpha__1 + beta__1)) + exp(4*W*(alpha__1 + beta__1)) + 1,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0, exp(W*(alpha__1 + 2*beta__1)) + exp(-W*(alpha__1 + 2*beta__1)) + exp(-2*W*(alpha__1 + 2*beta__1)) + exp(2*W*(alpha__1 + 2*beta__1)) + 1,                                                                                                                               0,                                                                               0,                                                                                                                               0,                                                                                                                                       0, exp(-2*W*beta__1) + exp(2*W*beta__1) + exp(-4*W*beta__1) + exp(4*W*beta__1) + 1,                                                                           0, 0,                                                                           0,                                                                               0, exp(W*(alpha__1 - 2*beta__1)) + exp(-W*(alpha__1 - 2*beta__1)) + exp(-2*W*(alpha__1 - 2*beta__1)) + exp(2*W*(alpha__1 - 2*beta__1)) + 1,                                                                                                                               0,                                                                               0,                                                                                                                               0,                                                                                                                                       0, exp(-2*W*(alpha__1 - beta__1)) + exp(2*W*(alpha__1 - beta__1)) + exp(-4*W*(alpha__1 - beta__1)) + exp(4*W*(alpha__1 - beta__1)) + 1,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0, exp(W*(2*alpha__1 + beta__1)) + exp(-W*(2*alpha__1 + beta__1)) + exp(-2*W*(2*alpha__1 + beta__1)) + exp(2*W*(2*alpha__1 + beta__1)) + 1,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0, exp(W*(alpha__1 + beta__1)) + exp(-W*(alpha__1 + beta__1)) + exp(-2*W*(alpha__1 + beta__1)) + exp(2*W*(alpha__1 + beta__1)) + 1,                                                                               0,                                                                                                                               0,                                                                                                                                       0,                                                                               0, exp(W*beta__1) + exp(-W*beta__1) + exp(-2*W*beta__1) + exp(2*W*beta__1) + 1, 0,                                                                           0,                                                                               0,                                                                                                                                       0, exp(W*(alpha__1 - beta__1)) + exp(-W*(alpha__1 - beta__1)) + exp(-2*W*(alpha__1 - beta__1)) + exp(2*W*(alpha__1 - beta__1)) + 1,                                                                               0,                                                                                                                               0,                                                                                                                                       0,                                                                                                                                   0, exp(W*(2*alpha__1 - beta__1)) + exp(-W*(2*alpha__1 - beta__1)) + exp(-2*W*(2*alpha__1 - beta__1)) + exp(2*W*(2*alpha__1 - beta__1)) + 1,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0, exp(-2*W*alpha__1) + exp(2*W*alpha__1) + exp(-4*W*alpha__1) + exp(4*W*alpha__1) + 1,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0,                                                                                                                               0, exp(W*alpha__1) + exp(-W*alpha__1) + exp(-2*W*alpha__1) + exp(2*W*alpha__1) + 1,                                                                                                                               0,                                                                                                                                       0,                                                                               0,                                                                           0, 5,                                                                           0,                                                                               0,                                                                                                                                       0,                                                                                                                               0, exp(W*alpha__1) + exp(-W*alpha__1) + exp(-2*W*alpha__1) + exp(2*W*alpha__1) + 1,                                                                                                                               0,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0, exp(-2*W*alpha__1) + exp(2*W*alpha__1) + exp(-4*W*alpha__1) + exp(4*W*alpha__1) + 1,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0,                                                                                   0, exp(W*(2*alpha__1 - beta__1)) + exp(-W*(2*alpha__1 - beta__1)) + exp(-2*W*(2*alpha__1 - beta__1)) + exp(2*W*(2*alpha__1 - beta__1)) + 1,                                                                                                                                   0,                                                                                                                                       0,                                                                                                                               0,                                                                               0, exp(W*(alpha__1 - beta__1)) + exp(-W*(alpha__1 - beta__1)) + exp(-2*W*(alpha__1 - beta__1)) + exp(2*W*(alpha__1 - beta__1)) + 1,                                                                                                                                       0,                                                                               0,                                                                           0, 0, exp(W*beta__1) + exp(-W*beta__1) + exp(-2*W*beta__1) + exp(2*W*beta__1) + 1,                                                                               0,                                                                                                                                       0,                                                                                                                               0,                                                                               0, exp(W*(alpha__1 + beta__1)) + exp(-W*(alpha__1 + beta__1)) + exp(-2*W*(alpha__1 + beta__1)) + exp(2*W*(alpha__1 + beta__1)) + 1,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0,                                                                                   0, exp(W*(2*alpha__1 + beta__1)) + exp(-W*(2*alpha__1 + beta__1)) + exp(-2*W*(2*alpha__1 + beta__1)) + exp(2*W*(2*alpha__1 + beta__1)) + 1,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0, exp(-2*W*(alpha__1 - beta__1)) + exp(2*W*(alpha__1 - beta__1)) + exp(-4*W*(alpha__1 - beta__1)) + exp(4*W*(alpha__1 - beta__1)) + 1,                                                                                                                                       0,                                                                                                                               0,                                                                               0,                                                                                                                               0, exp(W*(alpha__1 - 2*beta__1)) + exp(-W*(alpha__1 - 2*beta__1)) + exp(-2*W*(alpha__1 - 2*beta__1)) + exp(2*W*(alpha__1 - 2*beta__1)) + 1,                                                                               0,                                                                           0, 0,                                                                           0, exp(-2*W*beta__1) + exp(2*W*beta__1) + exp(-4*W*beta__1) + exp(4*W*beta__1) + 1,                                                                                                                                       0,                                                                                                                               0,                                                                               0,                                                                                                                               0, exp(W*(alpha__1 + 2*beta__1)) + exp(-W*(alpha__1 + 2*beta__1)) + exp(-2*W*(alpha__1 + 2*beta__1)) + exp(2*W*(alpha__1 + 2*beta__1)) + 1,                                                                                                                                   0,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0, exp(-2*W*(alpha__1 + beta__1)) + exp(2*W*(alpha__1 + beta__1)) + exp(-4*W*(alpha__1 + beta__1)) + exp(4*W*(alpha__1 + beta__1)) + 1;
 exp(-2*W*(alpha__2 + beta__2)) + exp(2*W*(alpha__2 + beta__2)) + exp(-4*W*(alpha__2 + beta__2)) + exp(4*W*(alpha__2 + beta__2)) + 1,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0, exp(W*(alpha__2 + 2*beta__2)) + exp(-W*(alpha__2 + 2*beta__2)) + exp(-2*W*(alpha__2 + 2*beta__2)) + exp(2*W*(alpha__2 + 2*beta__2)) + 1,                                                                                                                               0,                                                                               0,                                                                                                                               0,                                                                                                                                       0, exp(-2*W*beta__2) + exp(2*W*beta__2) + exp(-4*W*beta__2) + exp(4*W*beta__2) + 1,                                                                           0, 0,                                                                           0,                                                                               0, exp(W*(alpha__2 - 2*beta__2)) + exp(-W*(alpha__2 - 2*beta__2)) + exp(-2*W*(alpha__2 - 2*beta__2)) + exp(2*W*(alpha__2 - 2*beta__2)) + 1,                                                                                                                               0,                                                                               0,                                                                                                                               0,                                                                                                                                       0, exp(-2*W*(alpha__2 - beta__2)) + exp(2*W*(alpha__2 - beta__2)) + exp(-4*W*(alpha__2 - beta__2)) + exp(4*W*(alpha__2 - beta__2)) + 1,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0, exp(W*(2*alpha__2 + beta__2)) + exp(-W*(2*alpha__2 + beta__2)) + exp(-2*W*(2*alpha__2 + beta__2)) + exp(2*W*(2*alpha__2 + beta__2)) + 1,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0, exp(W*(alpha__2 + beta__2)) + exp(-W*(alpha__2 + beta__2)) + exp(-2*W*(alpha__2 + beta__2)) + exp(2*W*(alpha__2 + beta__2)) + 1,                                                                               0,                                                                                                                               0,                                                                                                                                       0,                                                                               0, exp(W*beta__2) + exp(-W*beta__2) + exp(-2*W*beta__2) + exp(2*W*beta__2) + 1, 0,                                                                           0,                                                                               0,                                                                                                                                       0, exp(W*(alpha__2 - beta__2)) + exp(-W*(alpha__2 - beta__2)) + exp(-2*W*(alpha__2 - beta__2)) + exp(2*W*(alpha__2 - beta__2)) + 1,                                                                               0,                                                                                                                               0,                                                                                                                                       0,                                                                                                                                   0, exp(W*(2*alpha__2 - beta__2)) + exp(-W*(2*alpha__2 - beta__2)) + exp(-2*W*(2*alpha__2 - beta__2)) + exp(2*W*(2*alpha__2 - beta__2)) + 1,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0, exp(-2*W*alpha__2) + exp(2*W*alpha__2) + exp(-4*W*alpha__2) + exp(4*W*alpha__2) + 1,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0,                                                                                                                               0, exp(W*alpha__2) + exp(-W*alpha__2) + exp(-2*W*alpha__2) + exp(2*W*alpha__2) + 1,                                                                                                                               0,                                                                                                                                       0,                                                                               0,                                                                           0, 5,                                                                           0,                                                                               0,                                                                                                                                       0,                                                                                                                               0, exp(W*alpha__2) + exp(-W*alpha__2) + exp(-2*W*alpha__2) + exp(2*W*alpha__2) + 1,                                                                                                                               0,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0, exp(-2*W*alpha__2) + exp(2*W*alpha__2) + exp(-4*W*alpha__2) + exp(4*W*alpha__2) + 1,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0,                                                                                   0, exp(W*(2*alpha__2 - beta__2)) + exp(-W*(2*alpha__2 - beta__2)) + exp(-2*W*(2*alpha__2 - beta__2)) + exp(2*W*(2*alpha__2 - beta__2)) + 1,                                                                                                                                   0,                                                                                                                                       0,                                                                                                                               0,                                                                               0, exp(W*(alpha__2 - beta__2)) + exp(-W*(alpha__2 - beta__2)) + exp(-2*W*(alpha__2 - beta__2)) + exp(2*W*(alpha__2 - beta__2)) + 1,                                                                                                                                       0,                                                                               0,                                                                           0, 0, exp(W*beta__2) + exp(-W*beta__2) + exp(-2*W*beta__2) + exp(2*W*beta__2) + 1,                                                                               0,                                                                                                                                       0,                                                                                                                               0,                                                                               0, exp(W*(alpha__2 + beta__2)) + exp(-W*(alpha__2 + beta__2)) + exp(-2*W*(alpha__2 + beta__2)) + exp(2*W*(alpha__2 + beta__2)) + 1,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0,                                                                                   0, exp(W*(2*alpha__2 + beta__2)) + exp(-W*(2*alpha__2 + beta__2)) + exp(-2*W*(2*alpha__2 + beta__2)) + exp(2*W*(2*alpha__2 + beta__2)) + 1,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0, exp(-2*W*(alpha__2 - beta__2)) + exp(2*W*(alpha__2 - beta__2)) + exp(-4*W*(alpha__2 - beta__2)) + exp(4*W*(alpha__2 - beta__2)) + 1,                                                                                                                                       0,                                                                                                                               0,                                                                               0,                                                                                                                               0, exp(W*(alpha__2 - 2*beta__2)) + exp(-W*(alpha__2 - 2*beta__2)) + exp(-2*W*(alpha__2 - 2*beta__2)) + exp(2*W*(alpha__2 - 2*beta__2)) + 1,                                                                               0,                                                                           0, 0,                                                                           0, exp(-2*W*beta__2) + exp(2*W*beta__2) + exp(-4*W*beta__2) + exp(4*W*beta__2) + 1,                                                                                                                                       0,                                                                                                                               0,                                                                               0,                                                                                                                               0, exp(W*(alpha__2 + 2*beta__2)) + exp(-W*(alpha__2 + 2*beta__2)) + exp(-2*W*(alpha__2 + 2*beta__2)) + exp(2*W*(alpha__2 + 2*beta__2)) + 1,                                                                                                                                   0,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0, exp(-2*W*(alpha__2 + beta__2)) + exp(2*W*(alpha__2 + beta__2)) + exp(-4*W*(alpha__2 + beta__2)) + exp(4*W*(alpha__2 + beta__2)) + 1;
                                                                                                       exp(4*W*(alpha__3 + beta__3)),                                                                                                         exp(2*W*(alpha__3 + 2*beta__3)),                                                                    exp(4*W*beta__3),                                                                                                        exp(-2*W*(alpha__3 - 2*beta__3)),                                                                                                      exp(-4*W*(alpha__3 - beta__3)),                                                                                                         exp(2*W*(2*alpha__3 + beta__3)),                                                                                                   exp(2*W*(alpha__3 + beta__3)),                                                                exp(2*W*beta__3),                                                                                                  exp(-2*W*(alpha__3 - beta__3)),                                                                                                        exp(-2*W*(2*alpha__3 - beta__3)),                                                               exp(4*W*alpha__3),                                                           exp(2*W*alpha__3), 1,                                                          exp(-2*W*alpha__3),                                                              exp(-4*W*alpha__3),                                                                                                         exp(2*W*(2*alpha__3 - beta__3)),                                                                                                   exp(2*W*(alpha__3 - beta__3)),                                                               exp(-2*W*beta__3),                                                                                                  exp(-2*W*(alpha__3 + beta__3)),                                                                                                        exp(-2*W*(2*alpha__3 + beta__3)),                                                                                                       exp(4*W*(alpha__3 - beta__3)),                                                                                                         exp(2*W*(alpha__3 - 2*beta__3)),                                                                   exp(-4*W*beta__3),                                                                                                        exp(-2*W*(alpha__3 + 2*beta__3)),                                                                                                      exp(-4*W*(alpha__3 + beta__3));
                                                                                                       exp(2*W*(alpha__3 + beta__3)),                                                                                                           exp(W*(alpha__3 + 2*beta__3)),                                                                    exp(2*W*beta__3),                                                                                                          exp(-W*(alpha__3 - 2*beta__3)),                                                                                                      exp(-2*W*(alpha__3 - beta__3)),                                                                                                           exp(W*(2*alpha__3 + beta__3)),                                                                                                     exp(W*(alpha__3 + beta__3)),                                                                  exp(W*beta__3),                                                                                                    exp(-W*(alpha__3 - beta__3)),                                                                                                          exp(-W*(2*alpha__3 - beta__3)),                                                               exp(2*W*alpha__3),                                                             exp(W*alpha__3), 1,                                                            exp(-W*alpha__3),                                                              exp(-2*W*alpha__3),                                                                                                           exp(W*(2*alpha__3 - beta__3)),                                                                                                     exp(W*(alpha__3 - beta__3)),                                                                 exp(-W*beta__3),                                                                                                    exp(-W*(alpha__3 + beta__3)),                                                                                                          exp(-W*(2*alpha__3 + beta__3)),                                                                                                       exp(2*W*(alpha__3 - beta__3)),                                                                                                           exp(W*(alpha__3 - 2*beta__3)),                                                                   exp(-2*W*beta__3),                                                                                                          exp(-W*(alpha__3 + 2*beta__3)),                                                                                                      exp(-2*W*(alpha__3 + beta__3));
                                                                                                                                   1,                                                                                                                                       1,                                                                                   1,                                                                                                                                       1,                                                                                                                                   1,                                                                                                                                       1,                                                                                                                               1,                                                                               1,                                                                                                                               1,                                                                                                                                       1,                                                                               1,                                                                           1, 1,                                                                           1,                                                                               1,                                                                                                                                       1,                                                                                                                               1,                                                                               1,                                                                                                                               1,                                                                                                                                       1,                                                                                                                                   1,                                                                                                                                       1,                                                                                   1,                                                                                                                                       1,                                                                                                                                   1;
                                                                                                      exp(-2*W*(alpha__3 + beta__3)),                                                                                                          exp(-W*(alpha__3 + 2*beta__3)),                                                                   exp(-2*W*beta__3),                                                                                                           exp(W*(alpha__3 - 2*beta__3)),                                                                                                       exp(2*W*(alpha__3 - beta__3)),                                                                                                          exp(-W*(2*alpha__3 + beta__3)),                                                                                                    exp(-W*(alpha__3 + beta__3)),                                                                 exp(-W*beta__3),                                                                                                     exp(W*(alpha__3 - beta__3)),                                                                                                           exp(W*(2*alpha__3 - beta__3)),                                                              exp(-2*W*alpha__3),                                                            exp(-W*alpha__3), 1,                                                             exp(W*alpha__3),                                                               exp(2*W*alpha__3),                                                                                                          exp(-W*(2*alpha__3 - beta__3)),                                                                                                    exp(-W*(alpha__3 - beta__3)),                                                                  exp(W*beta__3),                                                                                                     exp(W*(alpha__3 + beta__3)),                                                                                                           exp(W*(2*alpha__3 + beta__3)),                                                                                                      exp(-2*W*(alpha__3 - beta__3)),                                                                                                          exp(-W*(alpha__3 - 2*beta__3)),                                                                    exp(2*W*beta__3),                                                                                                           exp(W*(alpha__3 + 2*beta__3)),                                                                                                       exp(2*W*(alpha__3 + beta__3));
                                                                                                      exp(-4*W*(alpha__3 + beta__3)),                                                                                                        exp(-2*W*(alpha__3 + 2*beta__3)),                                                                   exp(-4*W*beta__3),                                                                                                         exp(2*W*(alpha__3 - 2*beta__3)),                                                                                                       exp(4*W*(alpha__3 - beta__3)),                                                                                                        exp(-2*W*(2*alpha__3 + beta__3)),                                                                                                  exp(-2*W*(alpha__3 + beta__3)),                                                               exp(-2*W*beta__3),                                                                                                   exp(2*W*(alpha__3 - beta__3)),                                                                                                         exp(2*W*(2*alpha__3 - beta__3)),                                                              exp(-4*W*alpha__3),                                                          exp(-2*W*alpha__3), 1,                                                           exp(2*W*alpha__3),                                                               exp(4*W*alpha__3),                                                                                                        exp(-2*W*(2*alpha__3 - beta__3)),                                                                                                  exp(-2*W*(alpha__3 - beta__3)),                                                                exp(2*W*beta__3),                                                                                                   exp(2*W*(alpha__3 + beta__3)),                                                                                                         exp(2*W*(2*alpha__3 + beta__3)),                                                                                                      exp(-4*W*(alpha__3 - beta__3)),                                                                                                        exp(-2*W*(alpha__3 - 2*beta__3)),                                                                    exp(4*W*beta__3),                                                                                                         exp(2*W*(alpha__3 + 2*beta__3)),                                                                                                       exp(4*W*(alpha__3 + beta__3));
                                                                                                       exp(4*W*(alpha__4 + beta__4)),                                                                                                         exp(2*W*(alpha__4 + 2*beta__4)),                                                                    exp(4*W*beta__4),                                                                                                        exp(-2*W*(alpha__4 - 2*beta__4)),                                                                                                      exp(-4*W*(alpha__4 - beta__4)),                                                                                                         exp(2*W*(2*alpha__4 + beta__4)),                                                                                                   exp(2*W*(alpha__4 + beta__4)),                                                                exp(2*W*beta__4),                                                                                                  exp(-2*W*(alpha__4 - beta__4)),                                                                                                        exp(-2*W*(2*alpha__4 - beta__4)),                                                               exp(4*W*alpha__4),                                                           exp(2*W*alpha__4), 1,                                                          exp(-2*W*alpha__4),                                                              exp(-4*W*alpha__4),                                                                                                         exp(2*W*(2*alpha__4 - beta__4)),                                                                                                   exp(2*W*(alpha__4 - beta__4)),                                                               exp(-2*W*beta__4),                                                                                                  exp(-2*W*(alpha__4 + beta__4)),                                                                                                        exp(-2*W*(2*alpha__4 + beta__4)),                                                                                                       exp(4*W*(alpha__4 - beta__4)),                                                                                                         exp(2*W*(alpha__4 - 2*beta__4)),                                                                   exp(-4*W*beta__4),                                                                                                        exp(-2*W*(alpha__4 + 2*beta__4)),                                                                                                      exp(-4*W*(alpha__4 + beta__4));
                                                                                                       exp(2*W*(alpha__4 + beta__4)),                                                                                                           exp(W*(alpha__4 + 2*beta__4)),                                                                    exp(2*W*beta__4),                                                                                                          exp(-W*(alpha__4 - 2*beta__4)),                                                                                                      exp(-2*W*(alpha__4 - beta__4)),                                                                                                           exp(W*(2*alpha__4 + beta__4)),                                                                                                     exp(W*(alpha__4 + beta__4)),                                                                  exp(W*beta__4),                                                                                                    exp(-W*(alpha__4 - beta__4)),                                                                                                          exp(-W*(2*alpha__4 - beta__4)),                                                               exp(2*W*alpha__4),                                                             exp(W*alpha__4), 1,                                                            exp(-W*alpha__4),                                                              exp(-2*W*alpha__4),                                                                                                           exp(W*(2*alpha__4 - beta__4)),                                                                                                     exp(W*(alpha__4 - beta__4)),                                                                 exp(-W*beta__4),                                                                                                    exp(-W*(alpha__4 + beta__4)),                                                                                                          exp(-W*(2*alpha__4 + beta__4)),                                                                                                       exp(2*W*(alpha__4 - beta__4)),                                                                                                           exp(W*(alpha__4 - 2*beta__4)),                                                                   exp(-2*W*beta__4),                                                                                                          exp(-W*(alpha__4 + 2*beta__4)),                                                                                                      exp(-2*W*(alpha__4 + beta__4));
                                                                                                                                   1,                                                                                                                                       1,                                                                                   1,                                                                                                                                       1,                                                                                                                                   1,                                                                                                                                       1,                                                                                                                               1,                                                                               1,                                                                                                                               1,                                                                                                                                       1,                                                                               1,                                                                           1, 1,                                                                           1,                                                                               1,                                                                                                                                       1,                                                                                                                               1,                                                                               1,                                                                                                                               1,                                                                                                                                       1,                                                                                                                                   1,                                                                                                                                       1,                                                                                   1,                                                                                                                                       1,                                                                                                                                   1;
                                                                                                      exp(-2*W*(alpha__4 + beta__4)),                                                                                                          exp(-W*(alpha__4 + 2*beta__4)),                                                                   exp(-2*W*beta__4),                                                                                                           exp(W*(alpha__4 - 2*beta__4)),                                                                                                       exp(2*W*(alpha__4 - beta__4)),                                                                                                          exp(-W*(2*alpha__4 + beta__4)),                                                                                                    exp(-W*(alpha__4 + beta__4)),                                                                 exp(-W*beta__4),                                                                                                     exp(W*(alpha__4 - beta__4)),                                                                                                           exp(W*(2*alpha__4 - beta__4)),                                                              exp(-2*W*alpha__4),                                                            exp(-W*alpha__4), 1,                                                             exp(W*alpha__4),                                                               exp(2*W*alpha__4),                                                                                                          exp(-W*(2*alpha__4 - beta__4)),                                                                                                    exp(-W*(alpha__4 - beta__4)),                                                                  exp(W*beta__4),                                                                                                     exp(W*(alpha__4 + beta__4)),                                                                                                           exp(W*(2*alpha__4 + beta__4)),                                                                                                      exp(-2*W*(alpha__4 - beta__4)),                                                                                                          exp(-W*(alpha__4 - 2*beta__4)),                                                                    exp(2*W*beta__4),                                                                                                           exp(W*(alpha__4 + 2*beta__4)),                                                                                                       exp(2*W*(alpha__4 + beta__4));
                                                                                                      exp(-4*W*(alpha__4 + beta__4)),                                                                                                        exp(-2*W*(alpha__4 + 2*beta__4)),                                                                   exp(-4*W*beta__4),                                                                                                         exp(2*W*(alpha__4 - 2*beta__4)),                                                                                                       exp(4*W*(alpha__4 - beta__4)),                                                                                                        exp(-2*W*(2*alpha__4 + beta__4)),                                                                                                  exp(-2*W*(alpha__4 + beta__4)),                                                               exp(-2*W*beta__4),                                                                                                   exp(2*W*(alpha__4 - beta__4)),                                                                                                         exp(2*W*(2*alpha__4 - beta__4)),                                                              exp(-4*W*alpha__4),                                                          exp(-2*W*alpha__4), 1,                                                           exp(2*W*alpha__4),                                                               exp(4*W*alpha__4),                                                                                                        exp(-2*W*(2*alpha__4 - beta__4)),                                                                                                  exp(-2*W*(alpha__4 - beta__4)),                                                                exp(2*W*beta__4),                                                                                                   exp(2*W*(alpha__4 + beta__4)),                                                                                                         exp(2*W*(2*alpha__4 + beta__4)),                                                                                                      exp(-4*W*(alpha__4 - beta__4)),                                                                                                        exp(-2*W*(alpha__4 - 2*beta__4)),                                                                    exp(4*W*beta__4),                                                                                                         exp(2*W*(alpha__4 + 2*beta__4)),                                                                                                       exp(4*W*(alpha__4 + beta__4));
                                                                                                       exp(4*W*(alpha__5 + beta__5)),                                                                                                         exp(2*W*(alpha__5 + 2*beta__5)),                                                                    exp(4*W*beta__5),                                                                                                        exp(-2*W*(alpha__5 - 2*beta__5)),                                                                                                      exp(-4*W*(alpha__5 - beta__5)),                                                                                                         exp(2*W*(2*alpha__5 + beta__5)),                                                                                                   exp(2*W*(alpha__5 + beta__5)),                                                                exp(2*W*beta__5),                                                                                                  exp(-2*W*(alpha__5 - beta__5)),                                                                                                        exp(-2*W*(2*alpha__5 - beta__5)),                                                               exp(4*W*alpha__5),                                                           exp(2*W*alpha__5), 1,                                                          exp(-2*W*alpha__5),                                                              exp(-4*W*alpha__5),                                                                                                         exp(2*W*(2*alpha__5 - beta__5)),                                                                                                   exp(2*W*(alpha__5 - beta__5)),                                                               exp(-2*W*beta__5),                                                                                                  exp(-2*W*(alpha__5 + beta__5)),                                                                                                        exp(-2*W*(2*alpha__5 + beta__5)),                                                                                                       exp(4*W*(alpha__5 - beta__5)),                                                                                                         exp(2*W*(alpha__5 - 2*beta__5)),                                                                   exp(-4*W*beta__5),                                                                                                        exp(-2*W*(alpha__5 + 2*beta__5)),                                                                                                      exp(-4*W*(alpha__5 + beta__5));
                                                                                                       exp(2*W*(alpha__5 + beta__5)),                                                                                                           exp(W*(alpha__5 + 2*beta__5)),                                                                    exp(2*W*beta__5),                                                                                                          exp(-W*(alpha__5 - 2*beta__5)),                                                                                                      exp(-2*W*(alpha__5 - beta__5)),                                                                                                           exp(W*(2*alpha__5 + beta__5)),                                                                                                     exp(W*(alpha__5 + beta__5)),                                                                  exp(W*beta__5),                                                                                                    exp(-W*(alpha__5 - beta__5)),                                                                                                          exp(-W*(2*alpha__5 - beta__5)),                                                               exp(2*W*alpha__5),                                                             exp(W*alpha__5), 1,                                                            exp(-W*alpha__5),                                                              exp(-2*W*alpha__5),                                                                                                           exp(W*(2*alpha__5 - beta__5)),                                                                                                     exp(W*(alpha__5 - beta__5)),                                                                 exp(-W*beta__5),                                                                                                    exp(-W*(alpha__5 + beta__5)),                                                                                                          exp(-W*(2*alpha__5 + beta__5)),                                                                                                       exp(2*W*(alpha__5 - beta__5)),                                                                                                           exp(W*(alpha__5 - 2*beta__5)),                                                                   exp(-2*W*beta__5),                                                                                                          exp(-W*(alpha__5 + 2*beta__5)),                                                                                                      exp(-2*W*(alpha__5 + beta__5));
                                                                                                                                   1,                                                                                                                                       1,                                                                                   1,                                                                                                                                       1,                                                                                                                                   1,                                                                                                                                       1,                                                                                                                               1,                                                                               1,                                                                                                                               1,                                                                                                                                       1,                                                                               1,                                                                           1, 1,                                                                           1,                                                                               1,                                                                                                                                       1,                                                                                                                               1,                                                                               1,                                                                                                                               1,                                                                                                                                       1,                                                                                                                                   1,                                                                                                                                       1,                                                                                   1,                                                                                                                                       1,                                                                                                                                   1;
                                                                                                      exp(-2*W*(alpha__5 + beta__5)),                                                                                                          exp(-W*(alpha__5 + 2*beta__5)),                                                                   exp(-2*W*beta__5),                                                                                                           exp(W*(alpha__5 - 2*beta__5)),                                                                                                       exp(2*W*(alpha__5 - beta__5)),                                                                                                          exp(-W*(2*alpha__5 + beta__5)),                                                                                                    exp(-W*(alpha__5 + beta__5)),                                                                 exp(-W*beta__5),                                                                                                     exp(W*(alpha__5 - beta__5)),                                                                                                           exp(W*(2*alpha__5 - beta__5)),                                                              exp(-2*W*alpha__5),                                                            exp(-W*alpha__5), 1,                                                             exp(W*alpha__5),                                                               exp(2*W*alpha__5),                                                                                                          exp(-W*(2*alpha__5 - beta__5)),                                                                                                    exp(-W*(alpha__5 - beta__5)),                                                                  exp(W*beta__5),                                                                                                     exp(W*(alpha__5 + beta__5)),                                                                                                           exp(W*(2*alpha__5 + beta__5)),                                                                                                      exp(-2*W*(alpha__5 - beta__5)),                                                                                                          exp(-W*(alpha__5 - 2*beta__5)),                                                                    exp(2*W*beta__5),                                                                                                           exp(W*(alpha__5 + 2*beta__5)),                                                                                                       exp(2*W*(alpha__5 + beta__5));
                                                                                                      exp(-4*W*(alpha__5 + beta__5)),                                                                                                        exp(-2*W*(alpha__5 + 2*beta__5)),                                                                   exp(-4*W*beta__5),                                                                                                         exp(2*W*(alpha__5 - 2*beta__5)),                                                                                                       exp(4*W*(alpha__5 - beta__5)),                                                                                                        exp(-2*W*(2*alpha__5 + beta__5)),                                                                                                  exp(-2*W*(alpha__5 + beta__5)),                                                               exp(-2*W*beta__5),                                                                                                   exp(2*W*(alpha__5 - beta__5)),                                                                                                         exp(2*W*(2*alpha__5 - beta__5)),                                                              exp(-4*W*alpha__5),                                                          exp(-2*W*alpha__5), 1,                                                           exp(2*W*alpha__5),                                                               exp(4*W*alpha__5),                                                                                                        exp(-2*W*(2*alpha__5 - beta__5)),                                                                                                  exp(-2*W*(alpha__5 - beta__5)),                                                                exp(2*W*beta__5),                                                                                                   exp(2*W*(alpha__5 + beta__5)),                                                                                                         exp(2*W*(2*alpha__5 + beta__5)),                                                                                                      exp(-4*W*(alpha__5 - beta__5)),                                                                                                        exp(-2*W*(alpha__5 - 2*beta__5)),                                                                    exp(4*W*beta__5),                                                                                                         exp(2*W*(alpha__5 + 2*beta__5)),                                                                                                       exp(4*W*(alpha__5 + beta__5));
 exp(-2*W*(alpha__6 + beta__6)) + exp(2*W*(alpha__6 + beta__6)) + exp(-4*W*(alpha__6 + beta__6)) + exp(4*W*(alpha__6 + beta__6)) + 1,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0, exp(W*(alpha__6 + 2*beta__6)) + exp(-W*(alpha__6 + 2*beta__6)) + exp(-2*W*(alpha__6 + 2*beta__6)) + exp(2*W*(alpha__6 + 2*beta__6)) + 1,                                                                                                                               0,                                                                               0,                                                                                                                               0,                                                                                                                                       0, exp(-2*W*beta__6) + exp(2*W*beta__6) + exp(-4*W*beta__6) + exp(4*W*beta__6) + 1,                                                                           0, 0,                                                                           0,                                                                               0, exp(W*(alpha__6 - 2*beta__6)) + exp(-W*(alpha__6 - 2*beta__6)) + exp(-2*W*(alpha__6 - 2*beta__6)) + exp(2*W*(alpha__6 - 2*beta__6)) + 1,                                                                                                                               0,                                                                               0,                                                                                                                               0,                                                                                                                                       0, exp(-2*W*(alpha__6 - beta__6)) + exp(2*W*(alpha__6 - beta__6)) + exp(-4*W*(alpha__6 - beta__6)) + exp(4*W*(alpha__6 - beta__6)) + 1,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0, exp(W*(2*alpha__6 + beta__6)) + exp(-W*(2*alpha__6 + beta__6)) + exp(-2*W*(2*alpha__6 + beta__6)) + exp(2*W*(2*alpha__6 + beta__6)) + 1,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0, exp(W*(alpha__6 + beta__6)) + exp(-W*(alpha__6 + beta__6)) + exp(-2*W*(alpha__6 + beta__6)) + exp(2*W*(alpha__6 + beta__6)) + 1,                                                                               0,                                                                                                                               0,                                                                                                                                       0,                                                                               0, exp(W*beta__6) + exp(-W*beta__6) + exp(-2*W*beta__6) + exp(2*W*beta__6) + 1, 0,                                                                           0,                                                                               0,                                                                                                                                       0, exp(W*(alpha__6 - beta__6)) + exp(-W*(alpha__6 - beta__6)) + exp(-2*W*(alpha__6 - beta__6)) + exp(2*W*(alpha__6 - beta__6)) + 1,                                                                               0,                                                                                                                               0,                                                                                                                                       0,                                                                                                                                   0, exp(W*(2*alpha__6 - beta__6)) + exp(-W*(2*alpha__6 - beta__6)) + exp(-2*W*(2*alpha__6 - beta__6)) + exp(2*W*(2*alpha__6 - beta__6)) + 1,                                                                                   0,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0, exp(-2*W*alpha__6) + exp(2*W*alpha__6) + exp(-4*W*alpha__6) + exp(4*W*alpha__6) + 1,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0,                                                                                                                               0, exp(W*alpha__6) + exp(-W*alpha__6) + exp(-2*W*alpha__6) + exp(2*W*alpha__6) + 1,                                                                                                                               0,                                                                                                                                       0,                                                                               0,                                                                           0, 5,                                                                           0,                                                                               0,                                                                                                                                       0,                                                                                                                               0, exp(W*alpha__6) + exp(-W*alpha__6) + exp(-2*W*alpha__6) + exp(2*W*alpha__6) + 1,                                                                                                                               0,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0, exp(-2*W*alpha__6) + exp(2*W*alpha__6) + exp(-4*W*alpha__6) + exp(4*W*alpha__6) + 1,                                                                                                                                       0,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0,                                                                                   0, exp(W*(2*alpha__6 - beta__6)) + exp(-W*(2*alpha__6 - beta__6)) + exp(-2*W*(2*alpha__6 - beta__6)) + exp(2*W*(2*alpha__6 - beta__6)) + 1,                                                                                                                                   0,                                                                                                                                       0,                                                                                                                               0,                                                                               0, exp(W*(alpha__6 - beta__6)) + exp(-W*(alpha__6 - beta__6)) + exp(-2*W*(alpha__6 - beta__6)) + exp(2*W*(alpha__6 - beta__6)) + 1,                                                                                                                                       0,                                                                               0,                                                                           0, 0, exp(W*beta__6) + exp(-W*beta__6) + exp(-2*W*beta__6) + exp(2*W*beta__6) + 1,                                                                               0,                                                                                                                                       0,                                                                                                                               0,                                                                               0, exp(W*(alpha__6 + beta__6)) + exp(-W*(alpha__6 + beta__6)) + exp(-2*W*(alpha__6 + beta__6)) + exp(2*W*(alpha__6 + beta__6)) + 1,                                                                                                                                       0,                                                                                                                                   0,                                                                                                                                       0,                                                                                   0, exp(W*(2*alpha__6 + beta__6)) + exp(-W*(2*alpha__6 + beta__6)) + exp(-2*W*(2*alpha__6 + beta__6)) + exp(2*W*(2*alpha__6 + beta__6)) + 1,                                                                                                                                   0;
                                                                                                                                   0,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0, exp(-2*W*(alpha__6 - beta__6)) + exp(2*W*(alpha__6 - beta__6)) + exp(-4*W*(alpha__6 - beta__6)) + exp(4*W*(alpha__6 - beta__6)) + 1,                                                                                                                                       0,                                                                                                                               0,                                                                               0,                                                                                                                               0, exp(W*(alpha__6 - 2*beta__6)) + exp(-W*(alpha__6 - 2*beta__6)) + exp(-2*W*(alpha__6 - 2*beta__6)) + exp(2*W*(alpha__6 - 2*beta__6)) + 1,                                                                               0,                                                                           0, 0,                                                                           0, exp(-2*W*beta__6) + exp(2*W*beta__6) + exp(-4*W*beta__6) + exp(4*W*beta__6) + 1,                                                                                                                                       0,                                                                                                                               0,                                                                               0,                                                                                                                               0, exp(W*(alpha__6 + 2*beta__6)) + exp(-W*(alpha__6 + 2*beta__6)) + exp(-2*W*(alpha__6 + 2*beta__6)) + exp(2*W*(alpha__6 + 2*beta__6)) + 1,                                                                                                                                   0,                                                                                                                                       0,                                                                                   0,                                                                                                                                       0, exp(-2*W*(alpha__6 + beta__6)) + exp(2*W*(alpha__6 + beta__6)) + exp(-4*W*(alpha__6 + beta__6)) + exp(4*W*(alpha__6 + beta__6)) + 1 ]


fullSize =  M*Size*Size;
zerosCell = cell(fullSize-1 , 1 );
for h = 1: fullSize-1
    zerosCell{h} = 0;
end
% onesCell = cell(1, fullSize );
% for h = 1:fullSize
%     onesCell{h} = 1;
% end
indexes = 1:fullSize;


for m =1:m
    angle = (m-1)*180/M;
    beta_m = betas(m);
    
    FrFTUniBlock = reshape (  columnStackedIntermediate (  1 + (m-1)*Size^2 : (m)*Size^2  ) , [Size Size] );
    if (angle <= 45 || angle >= 135)
        for n =1:Size          % Column wise FrFT variable beta
            FrFTVarBlock =  sum( exp(W*beta_m* gridSpace) .* FrFTUniBlock );
            for z = 1: fullSize
                V___( n + (m-1)*Size, z) = subs(FrFTVarBlock(n) , columnStackedIntermediate (indexes (indexes ~= z)), zerosCell )/(columnStackedIntermediate(z)) ;  % get element a_m_n
            end
            V___(n + (m-1)*Size, :)
        end 
    else
        for n =1:Size          % row wise FrFT variable beta
            for n =1:Size
                FrFTVarBlock =  sum( exp(W*beta_m* gridSpace) .* FrFTUniBlock.' );
                for z = 1: fullSize
                    V___( n + (m-1)*Size, z) = subs(FrFTVarBlock(n) , columnStackedIntermediate (indexes (indexes ~= z)), zerosCell )/(columnStackedIntermediate(z)) ;  % get element a_m_n
                end
                V___(n + (m-1)*Size, :)
            end
        end
    end
end

V___

